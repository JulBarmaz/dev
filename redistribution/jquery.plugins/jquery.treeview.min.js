!function(p){p.extend(p.fn,{swapClass:function(a,e){var l=this.filter("."+a);return this.filter("."+e).removeClass(e).addClass(a),l.removeClass(a).addClass(e),this},replaceClass:function(a,e){return this.filter("."+a).removeClass(a).addClass(e).end()},hoverClass:function(a){return a=a||"hover",this.hover(function(){p(this).addClass(a)},function(){p(this).removeClass(a)})},heightToggle:function(a,e){a?this.animate({height:"toggle"},a,e):this.each(function(){jQuery(this)[jQuery(this).is(":hidden")?"show":"hide"](),e&&e.apply(this,arguments)})},heightHide:function(a,e){a?this.animate({height:"hide"},a,e):(this.hide(),e&&this.each(e))},prepareBranches:function(a){return a.prerendered||(this.filter(":last-child:not(ul)").addClass(c.last),this.filter((a.collapsed?"":"."+c.closed)+":not(."+c.open+")").find(">ul").hide()),this.filter(":has(>ul)")},applyClasses:function(a,e){this.filter(":has(>ul):not(:has(>a))").find(">span").unbind("click.treeview").bind("click.treeview",function(a){this==a.target&&e.apply(p(this).next())}).add(p("a",this)).hoverClass(),a.prerendered||(this.filter(":has(>ul:hidden)").addClass(c.expandable).replaceClass(c.last,c.lastExpandable),this.not(":has(>ul:hidden)").addClass(c.collapsable).replaceClass(c.last,c.lastCollapsable),(a=(a=this.find("div."+c.hitarea)).length?a:this.prepend('<div class="'+c.hitarea+'"/>').find("div."+c.hitarea)).removeClass().addClass(c.hitarea).each(function(){var a="";p.each(p(this).parent().attr("class").split(" "),function(){a+=this+"-hitarea "}),p(this).addClass(a)})),this.find("div."+c.hitarea).click(e)},treeview:function(a){var e;function l(){p(this).parent().find(">.hitarea").swapClass(c.collapsableHitarea,c.expandableHitarea).swapClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().swapClass(c.collapsable,c.expandable).swapClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightToggle(a.animated,a.toggle),a.unique&&p(this).parent().siblings().find(">.hitarea").replaceClass(c.collapsableHitarea,c.expandableHitarea).replaceClass(c.lastCollapsableHitarea,c.lastExpandableHitarea).end().replaceClass(c.collapsable,c.expandable).replaceClass(c.lastCollapsable,c.lastExpandable).find(">ul").heightHide(a.animated,a.toggle)}(a=p.extend({cookieId:"treeview"},a)).toggle&&(e=a.toggle,a.toggle=function(){return e.apply(p(this).parent()[0],arguments)}),this.data("toggler",l),this.addClass("treeview");var s,t,i,n=this.find("li").prepareBranches(a);switch(a.persist){case"cookie":var r=a.toggle;a.toggle=function(){var l;l=[],n.each(function(a,e){l[a]=p(e).is(":has(>ul:visible)")?1:0}),p.cookie(a.cookieId,l.join(""),{expires:0,path:"/"}),r&&r.apply(this,arguments)},(h=p.cookie(a.cookieId))&&(s=h.split(""),n.each(function(a,e){p(e).find(">ul")[parseInt(s[a])?"show":"hide"]()}));break;case"location":var o,h=this.find("a").filter(function(){return this.href.toLowerCase()==location.href.toLowerCase()});h.length&&(o=h.addClass("selected").parents("ul, li").add(h.next()).show(),a.prerendered&&o.filter("li").swapClass(c.collapsable,c.expandable).swapClass(c.lastCollapsable,c.lastExpandable).find(">.hitarea").swapClass(c.collapsableHitarea,c.expandableHitarea).swapClass(c.lastCollapsableHitarea,c.lastExpandableHitarea))}function d(a){return function(){return l.apply(p("div."+c.hitarea,t).filter(function(){return!a||p(this).parent("."+a).length})),!1}}return n.applyClasses(a,l),a.control&&(t=this,i=a.control,p("a:eq(0)",i).click(d(c.collapsable)),p("a:eq(1)",i).click(d(c.expandable)),p("a:eq(2)",i).click(d()),p(a.control).show()),this}}),p.treeview={};var c=p.treeview.classes={open:"open",closed:"closed",expandable:"expandable",expandableHitarea:"expandable-hitarea",lastExpandableHitarea:"lastExpandable-hitarea",collapsable:"collapsable",collapsableHitarea:"collapsable-hitarea",lastCollapsableHitarea:"lastCollapsable-hitarea",lastCollapsable:"lastCollapsable",lastExpandable:"lastExpandable",last:"last",hitarea:"hitarea"}}(jQuery);